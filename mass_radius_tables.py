import numpy as np
import math
from scipy import interpolate

def GetDensity(x,mcore):
  #x - percentage of iron
  #PARAMETERS
  ME = 5.9722*math.pow(10,27)#in grams
  RE = 6.371*math.pow(10,8)#in cm

  if x == 33:
    mass = [0.2,0.4,0.6,0.8,1.,2.,3.,4.,5.,6.,7.,8.,9.,10.,12.,14.,16.,18.,20.]
    #radius = [0.593662,0.737793,0.835511,0.911201,0.973627,1.18822,1.32751,1.43167,1.51499,1.58431,1.64351,1.69501,1.74045,1.78097,1.85037,1.90784,1.95624,1.99745,2.03281]
    radius = [0.592384,0.736224,0.833926,0.909741,0.972372,1.18850,1.32962,1.43571,1.52093,1.59214,1.65321,1.70657,1.75383,1.79616,1.86914,1.93012,1.98200,2.02670,2.06553]

  if x == 70:
    mass = [0.2,0.4,0.6,0.8,1.,2.,3.,4.,5.,6.,7.,8.,9.,10.,12.,14.,16.,18.,20.]
    radius = [0.535687,0.662772,0.748595,0.814977,0.869685,1.05786,1.18039,1.27243,1.34640,1.40823,1.46131,1.50776,1.54895,1.58589,1.64978,1.70339,1.74922,1.78893,1.82366]

  mass = np.array(mass)*ME
  radius = np.array(radius)*RE
  density = mass/(4.*math.pi/3.*radius**3.)
  f = interpolate.interp1d(mass,density,kind='cubic')

  return f(mcore*ME)

